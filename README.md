# ğŸ† Amazon ML Challenge 2025: Smart Product Pricing

<div align="center">

![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)
![Deep Learning](https://img.shields.io/badge/Deep%20Learning-PyTorch-red.svg)
![Status](https://img.shields.io/badge/SMAPE-53.99%25-success.svg)

**Multi-Modal Deep Learning Pipeline for Intelligent Price Prediction**

</div>

---

## ğŸ¯ Problem Statement

Predict product prices using multi-modal data:
- ğŸ“ Product descriptions (text)
- ğŸ–¼ï¸ Product images
- ğŸ’° Historical pricing

---

## ğŸ—ï¸ Solution Architecture

### **High-Level Pipeline Overview**

```
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
    â”ƒ              INPUT LAYER (Raw Data)                   â”ƒ
    â”£â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”«
    â”ƒ  ğŸ“ Product Text  â”‚  ğŸ–¼ï¸ Product Images  â”‚  ğŸ’° Prices   â”ƒ
    â”—â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
                 â•‘                         â•‘
                 â–¼                         â–¼
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
    â”ƒ   STAGE 1: Extract   â”ƒ  â”ƒ  STAGE 2: Generate   â”ƒ
    â”ƒ   Base Features      â”ƒ  â”ƒ  Multi-Modal Data    â”ƒ
    â”ƒ                      â”ƒ  â”ƒ                      â”ƒ
    â”ƒ  â€¢ Text Parsing      â”ƒ  â”ƒ  â€¢ Text Embeddings   â”ƒ
    â”ƒ  â€¢ Unit Convert      â”ƒ  â”ƒ  â€¢ Image Embeddings  â”ƒ
    â”ƒ  â€¢ Brand Encoding    â”ƒ  â”ƒ  â€¢ KNN Features      â”ƒ
    â”ƒ  â€¢ TF-IDF Features   â”ƒ  â”ƒ                      â”ƒ
    â”ƒ                      â”ƒ  â”ƒ  Output: 3,212 feat. â”ƒ
    â”ƒ  Output: 520 feat.   â”ƒ  â”ƒ                      â”ƒ
    â”—â”â”â”â”â”â”â”â”â”¬â”â”â”â”â”â”â”â”â”â”â”â”â”›  â”—â”â”â”â”â”â”â”â”â”¬â”â”â”â”â”â”â”â”â”â”â”â”â”›
             â”‚                        â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â–¼
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
    â”ƒ         STAGE 3: ENSEMBLE MODELING                    â”ƒ
    â”ƒ                                                       â”ƒ
    â”ƒ   ğŸ“Š Consolidated Features: ~3,732                   â”ƒ
    â”ƒ                                                       â”ƒ
    â”ƒ   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”ƒ
    â”ƒ   â”‚   LightGBM Model     â”‚  â”‚  CatBoost Model      â”‚ â”ƒ
    â”ƒ   â”‚   â€¢ 1000 trees       â”‚  â”‚  â€¢ 1000 trees        â”‚ â”ƒ
    â”ƒ   â”‚   â€¢ Depth: 7         â”‚  â”‚  â€¢ Depth: 7          â”‚ â”ƒ
    â”ƒ   â”‚   â€¢ LR: 0.05         â”‚  â”‚  â€¢ LR: 0.05          â”‚ â”ƒ
    â”ƒ   â”‚   â€¢ SMAPE: 54.78%    â”‚  â”‚  â€¢ SMAPE: 54.52%     â”‚ â”ƒ
    â”ƒ   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”ƒ
    â”ƒ              â”‚                         â”‚              â”ƒ
    â”ƒ              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”ƒ
    â”ƒ                            â–¼                          â”ƒ
    â”ƒ               Final = (LightGBM + CatBoost) / 2      â”ƒ
    â”ƒ                                                       â”ƒ
    â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
                              â–¼
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
    â”ƒ         ğŸ¯ OUTPUT: Price Predictions                 â”ƒ
    â”ƒ         âœ… SMAPE: 53.99%                              â”ƒ
    â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
```

---

### **STAGE 1: Feature Extraction** (520 features)

```
INPUT: Product Text Descriptions
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              TEXT PARSING & CLEANING                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Pack Qty    â”‚  â”‚   Weight     â”‚  â”‚   Volume     â”‚  â”‚
â”‚  â”‚  Extraction  â”‚  â”‚  Extraction  â”‚  â”‚  Extraction  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           UNIT STANDARDIZATION                          â”‚
â”‚  Weight â†’ grams  â”‚  Volume â†’ milliliters  â”‚ Values OK  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              FEATURE ENGINEERING                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â€¢ Brand Target Encoding (smoothed)              â”‚  â”‚
â”‚  â”‚  â€¢ TF-IDF Features from description (500 feat.)  â”‚  â”‚
â”‚  â”‚  â€¢ Interaction Features                          â”‚  â”‚
â”‚  â”‚    - pack_weight_ratio                           â”‚  â”‚
â”‚  â”‚    - brand_avg_price                             â”‚  â”‚
â”‚  â”‚  â€¢ Price Normalization & Smoothing               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â–¼
         âœ… OUTPUT: 520 numerical features
```

---

### **STAGE 2: Multi-Modal Embeddings** (3,212 features)

#### **Part A: Parallel Embedding Generation**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    TEXT EMBEDDINGS                 â”‚    â”‚    IMAGE EMBEDDINGS                â”‚
â”‚    (5 Transformer Models)          â”‚    â”‚    (EfficientNet-B0 CNN)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                    â”‚    â”‚                                    â”‚
â”‚  1ï¸âƒ£  MiniLM-L6-v2                  â”‚    â”‚  ğŸ–¼ï¸  EfficientNet-B0               â”‚
â”‚      â””â”€ 384-dim vectors            â”‚    â”‚      â””â”€ Pre-trained on ImageNet    â”‚
â”‚                                    â”‚    â”‚      â””â”€ Global Average Pooling    â”‚
â”‚  2ï¸âƒ£  Multilingual MiniLM           â”‚    â”‚      â””â”€ 1280-dimensional output   â”‚
â”‚      â””â”€ 384-dim vectors            â”‚    â”‚                                    â”‚
â”‚                                    â”‚    â”‚                                    â”‚
â”‚  3ï¸âƒ£  all-MiniLM-L12                â”‚    â”‚                                    â”‚
â”‚      â””â”€ 384-dim vectors            â”‚    â”‚                                    â”‚
â”‚                                    â”‚    â”‚                                    â”‚
â”‚  4ï¸âƒ£  distiluse-base                â”‚    â”‚                                    â”‚
â”‚      â””â”€ 384-dim vectors            â”‚    â”‚                                    â”‚
â”‚                                    â”‚    â”‚                                    â”‚
â”‚  5ï¸âƒ£  all-MiniLM-L6                 â”‚    â”‚                                    â”‚
â”‚      â””â”€ 384-dim vectors            â”‚    â”‚                                    â”‚
â”‚                                    â”‚    â”‚                                    â”‚
â”‚  Total: 5 Ã— 384 = 1920 features   â”‚    â”‚  Total: 1280 features             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                                        â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ CONCATENATED EMBEDDING SPACE         â”‚
                â”‚ 1920 + 1280 = 3200 dimensions       â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### **Part B: KNN Similarity Features**

```
Using 3,200-dimensional Concatenated Embeddings
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              K-NEAREST NEIGHBORS ANALYSIS (K=10)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  ğŸ“Š TEXT SPACE KNN                                           â”‚
â”‚  â”œâ”€ Mean Price of 10 nearest neighbors                       â”‚
â”‚  â”œâ”€ Std Dev of neighbor prices                              â”‚
â”‚  â”œâ”€ Min price among neighbors                               â”‚
â”‚  â””â”€ Max price among neighbors                               â”‚
â”‚                                                              â”‚
â”‚  ğŸ–¼ï¸ IMAGE SPACE KNN                                          â”‚
â”‚  â”œâ”€ Mean Price of 10 nearest neighbors                       â”‚
â”‚  â”œâ”€ Std Dev of neighbor prices                              â”‚
â”‚  â”œâ”€ Min price among neighbors                               â”‚
â”‚  â””â”€ Max price among neighbors                               â”‚
â”‚                                                              â”‚
â”‚  ğŸ¯ COMBINED SPACE KNN                                       â”‚
â”‚  â”œâ”€ Mean Price of 10 nearest neighbors                       â”‚
â”‚  â”œâ”€ Std Dev of neighbor prices                              â”‚
â”‚  â”œâ”€ Min price among neighbors                               â”‚
â”‚  â””â”€ Max price among neighbors                               â”‚
â”‚                                                              â”‚
â”‚  Total KNN Features: 4 metrics Ã— 3 spaces = 12 features    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### **Part C: Stage 2 Output Summary**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   STAGE 2 CONSOLIDATED OUTPUT                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ Text Embeddings (5 models):    1920 feat.   â”‚
â”‚  â€¢ Image Embeddings (1 model):    1280 feat.   â”‚
â”‚  â€¢ KNN Features (3 spaces):          12 feat.   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  TOTAL:                            3212 feat.  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### **STAGE 3: Ensemble Modeling** (~3,732 features)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        CONSOLIDATED FEATURE MATRIX                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  From STAGE 1:  Numerical Features        ~520 feat.       â”‚
â”‚  From STAGE 2:  Text Embeddings           1920 feat.       â”‚
â”‚  From STAGE 2:  Image Embeddings          1280 feat.       â”‚
â”‚  From STAGE 2:  KNN Features                 12 feat.       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  TOTAL:                                   ~3,732 feat.     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚   SPLIT: Train & Validation Data     â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚     GRADIENT BOOSTING MODELS       â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚                                    â”‚
        â”‚  ğŸŸ¦ LightGBM                       â”‚
        â”‚  â”œâ”€ Trees: 1000                   â”‚
        â”‚  â”œâ”€ Max Depth: 7                  â”‚
        â”‚  â”œâ”€ Learning Rate: 0.05           â”‚
        â”‚  â”œâ”€ Num Leaves: 31                â”‚
        â”‚  â””â”€ SMAPE: 54.78%                 â”‚
        â”‚                                    â”‚
        â”‚  ğŸŸª CatBoost                       â”‚
        â”‚  â”œâ”€ Trees: 1000                   â”‚
        â”‚  â”œâ”€ Max Depth: 7                  â”‚
        â”‚  â”œâ”€ Learning Rate: 0.05           â”‚
        â”‚  â”œâ”€ Handle Cat Features: Yes      â”‚
        â”‚  â””â”€ SMAPE: 54.52%                 â”‚
        â”‚                                    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   ENSEMBLE AVERAGING               â”‚
        â”‚   Final = (LightGBM + CatBoost)/2  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â–¼
        âœ… FINAL PREDICTIONS
           SMAPE: 53.99% â­
```

---

## ğŸ“Š Complete Data Flow Diagram

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   INPUT DATA     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼                  â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  TEXT DATA    â”‚  â”‚  IMAGE DATA  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                 â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â–¼
            â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
            â”ƒ  STAGE 1: EXTRACT FEATURES  â”ƒ
            â”ƒ  Output: 520 features       â”ƒ
            â”—â”â”â”â”â”â”â”â”â”â”â”¬â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
                       â–¼
            â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
            â”ƒ STAGE 2: EMBEDDINGS + KNN   â”ƒ
            â”ƒ Output: 3,212 features      â”ƒ
            â”—â”â”â”â”â”â”â”â”â”â”â”¬â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
                       â–¼
            â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
            â”ƒ STAGE 3: ENSEMBLE TRAINING  â”ƒ
            â”ƒ 3,732 consolidated features â”‚
            â”ƒ LightGBM + CatBoost average â”‚
            â”—â”â”â”â”â”â”â”â”â”â”â”¬â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
                       â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  ğŸ¯ PRICE PREDICTIONS    â”‚
            â”‚  âœ… SMAPE: 53.99%        â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ Feature Importance Distribution

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        TOP 10 FEATURE CONTRIBUTIONS             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚  1. knn_mean_price_combined  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 18.2%â”‚
â”‚  2. brand_target_encoded     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 12.4%    â”‚
â”‚  3. knn_mean_price_text      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 9.8%       â”‚
â”‚  4. weight_grams             â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 7.3%        â”‚
â”‚  5. knn_std_price_combined   â–ˆâ–ˆâ–ˆâ–ˆ 6.5%         â”‚
â”‚  6. image_embedding_0        â–ˆâ–ˆâ–ˆ 5.1%          â”‚
â”‚  7. pack_quantity            â–ˆâ–ˆâ–ˆ 4.9%          â”‚
â”‚  8. knn_mean_price_image     â–ˆâ–ˆ 4.2%           â”‚
â”‚  9. volume_ml                â–ˆâ–ˆ 3.8%           â”‚
â”‚  10. text_embedding_1_0      â–ˆâ–ˆ 3.1%           â”‚
â”‚                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Model Performance

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              PERFORMANCE METRICS                          â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                           â•‘
â•‘  ğŸ“Š LightGBM (Single Model)        â†’  54.78% SMAPE       â•‘
â•‘  ğŸ“Š CatBoost (Single Model)        â†’  54.52% SMAPE       â•‘
â•‘                                                           â•‘
â•‘  âœ… ENSEMBLE (Average)             â†’  53.99% SMAPE â­    â•‘
â•‘                                                           â•‘
â•‘  ğŸš€ Improvement from Ensemble:  â†“ 0.53% SMAPE           â•‘
â•‘                                                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ğŸš€ Quick Start

```bash
# Stage 1: Extract features
python enhanced_feature_extraction.py

# Stage 2: Generate embeddings (GPU recommended)
python generate_all_embeddings.py

# Stage 3: Train and predict
python validate_and_submit_ensemble.py
```

---

## ğŸ“¦ Tech Stack

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DEEP LEARNING                              â”‚
â”‚  â€¢ PyTorch                                  â”‚
â”‚  â€¢ Sentence Transformers                    â”‚
â”‚  â€¢ EfficientNet (timm)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  GRADIENT BOOSTING                          â”‚
â”‚  â€¢ LightGBM                                 â”‚
â”‚  â€¢ CatBoost                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  SIMILARITY SEARCH                          â”‚
â”‚  â€¢ FAISS (Facebook AI)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  DATA PROCESSING                            â”‚
â”‚  â€¢ Pandas, NumPy, Scikit-learn              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¡ Key Innovation

Our solution's strength lies in **three-level similarity features**:
1. ğŸ”¤ **Text-based neighbors** â†’ Semantically similar products
2. ğŸ–¼ï¸ **Image-based neighbors** â†’ Visually similar products  
3. ğŸ¯ **Combined neighbors** â†’ Holistically similar products

Each level captures different pricing patterns, creating a robust feature set.

---

## ğŸ“ Results Summary

âœ… **Validation SMAPE: 53.99%**  
âœ… **3,732 engineered features**  
âœ… **5 text embedding models**  
âœ… **Multi-space KNN features**  
âœ… **Robust ensemble approach**

---

<div align="center">

**â­ Star this repo if you found it helpful! â­**

Made with â¤ï¸ for Amazon ML Challenge 2025

</div>
